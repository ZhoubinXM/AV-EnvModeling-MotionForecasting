# General parameters
batch_size: 128
num_workers: 1
log_freq: 100
num_epochs: 100
world_size: 8
past_length: 5
pred_length: 6

# Dataset
dataset: img_dataset
train_datafile:
  # root_dir: '/data/guifeng/traject_model/train_dataset_vectornet'
  root_dir: '/data/guifeng/nuscenes/prediction/train'
val_datafile:
  # root_dir: '/data/guifeng/traject_model/val_dataset_vectornet'
  root_dir: '/data/guifeng/nuscenes/prediction/val'



# Model parameters
# Encoder parameters
encoder_type: 'img_bev_enc'
encoder_args:
  use_img: False
  backbone: 'resnet50'
  train_backbone: True
  return_interm_layer: False
  dilation: True
  bev_feature_size: 10
  hidden_size: 128
  depth: 3
  use_subgraph: False

# Aggregator parameters
aggregator_type: 'spatial_aggregator'
aggregator_args:
  hidden_size: 128


# Decoder parameters
decoder_type: 'residual_concat_mlp'
decoder_args:
  hidden_size: 128
  in_features: 128 + 128
  pred_length: 6
  pred_num: 6
  pred_feature: 2


# Optimizer parameters
optim_args:
  lr: 0.001


losses: ['variety_loss']
loss_weights: [1]
loss_args:
  -

tr_metrics: ['variety_loss', 'min_ade', 'min_fde', 'miss_rate', 'min_ade', 'min_fde', 'miss_rate']
tr_metric_args:
  -
  - k: 1
  - k: 1
  - k: 1
    dist_thresh: 2.0
  - k: 5
  - k: 6
  - k: 6
    dist_thresh: 2.0


val_metrics: ['variety_loss', 'min_ade', 'min_fde', 'miss_rate', 'min_ade', 'min_fde', 'miss_rate', 'min_ade', 'min_fde', 'miss_rate', 'min_ade', 'min_fde', 'miss_rate']
val_metric_args:
  -
  - k: 1
  - k: 1
  - k: 1
    dist_thresh: 2.0
  - k: 3
  - k: 3
  - k: 3
    dist_thresh: 2.0
  - k: 5
  - k: 5
  - k: 5
    dist_thresh: 2.0
  - k: 6
  - k: 6
  - k: 6
    dist_thresh: 2.0
